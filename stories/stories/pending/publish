Story: After finding a pending story...  I should be published

  As a publisher of merbcasts
  I want to publish pending casts
  So that they are available on the public page.
  
  Scenario: A clean database
    Given no authors in the database
    And no current casts in the database
  
  Scenario: A publisher publishes a pending cast
    GivenScenario: A clean database
    And an active author named: giles
    And 5 current pending casts in the database
    And an active publisher named: lulu
    And using the first pending cast found belonging to: giles

    When the publisher publishes the cast

    Then the cast should be: published
    And there should be 4 pending casts
    And there should be 1 published casts
    And the author should be redirected to the current cast show page
   
  Scenario: An anonymous user tries to publish a pending cast
    GivenScenario: A clean database
    And an active author named: ted
    And 3 current pending casts in the database
    And an anonymous author
    And using the first pending cast found belonging to: ted
    
    When the publisher publishes the cast
    
    Then the author should be redirected to: /login
    And there should be 3 pending casts
    And there should be 0 published casts
    
  Scenario: An active author tries to publish a pending cast they own
    GivenScenario: A clean database
    And an active author named: phil
    And 3 current pending casts in the database
    And using the first pending cast found belonging to: phil
    
    When the publisher publishes the cast
    
    Then the author should see the error page: Unauthorized
    And there should be 3 pending casts
    And there should be 0 published casts
    
  Scenario: An active author tries to publish a cast they do not own
    GivenScenario: A clean database
    And an active author named: phil
    And 3 current pending casts in the database
    And using the first pending cast found belonging to: phil
    And an active author named: david
    
    When the publisher publishes the cast
    
    Then the author should see the error page: Unauthorized
    And there should be 3 pending casts
    And there should be 0 published casts